"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["1441"],{848303:function(e,t){t.Z={promptWithImgWrapperHeight:"24px",promptWithImgWrapperWidth:"123px",promptSeedIconSize:"12px",videoPromptPaddingVertical:"12px",videoControlsHeight:"32px",videoPaddingTop:"20px",videoMarginBottom:"28px",generateListPadding:"24px",generateListDateWidth:"46px",videoContainerPaddingRight:"86px",feedCarouselHeight:"220px",videoFeedHeaderHeight:"45px",generatePanelMarginLeft:"16px",masonryGap:"8px",generationEntryHeight:"172px",generationEntryMarginBottom:"16px",videoMenuItemWidth:"184px",videoMenuWidth:"160px",exploreFeedTabHeight:"32px",exploreFeedTabPaddingBottom:"20px",headerHeight:"76px",exploreFeedCategoryHeight:"32px",exploreFeedCategoryPaddingBottom:"16px",videoMoreWidth:"16px",generateListPaddingTop:"4px",videoFailPaddingH:"12px",videoFailPaddingV:"8px",videoFailIconMargin:"8px",videoFailIconSize:"16px",personalMarginTop:"100px",personalProfileHeight:"250px",personalProfileWidthLarge:"360px",personalProfileWidthSmall:"320px",personalProfileWidthBreakPoint:"1536px",personalScrollHeaderGap:"24px",storyEditorPadding:"8px",storyExSmallScreenWidth:"1146px",storySmallScreenWidth:"1280px",storyMiddleScreenWidth:"1280px",storyLargeScreenWidth:"1280px",storyExLargeScreenWidth:"1536px",storySmallPromptWidth:"240px",storyMiddlePromptWidth:"280px",storyLargePromptWidth:"320px",pageIconColor:"#8f9ca5",videoRelaxProcessingHeight:"68px",timelineLargeGap:"16px",timelineThumbnailHeightTime:"125px",timelineScrollWidth:"6px",timelineInsertSegmentBtnWidth:"16px",characterGenerateModalPanelWidth:"280px",characterGenerateModalHeaderHeight:"48px",largestScreenWidth:"1920px",largeContainerWidth:"1650px",smallScreenWidth:"1024px",scrollBarWidth:"2px","largeScreenGenerate-Width":"1398px",largeScreenGenerateWidth:"1398px",middleScreenGenerateWidth:"1366px",smallestScreenGenerateWidth:"1024px",generateVideoCardMaxWidth:"526px",generateVideoCardMinWidth:"383px",generateCardMarginLeft:"12px",generateCardSideBarWidth:"24px",generateCardHoverButtonSize:"28px",generateCardBgmButtonWidth:"68px",storyboardContainerPadding:"16px",storyboardGap:"4px",generateContainerAnimationDuration:".5s",videoPromptTabHeight:"36px",videoPromptTabMarginBottom:"8px",agentChatMinHeight:"132px",promptTabHeight:"44px"}},743907:function(e,t,i){i.d(t,{SV:function(){return a}});var n=i(218571);let r=(0,n.createContext)(null),o={didCatch:!1,error:null};class a extends n.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=o}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,i,n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];null===(t=(i=this.props).onReset)||void 0===t||t.call(i,{args:r,reason:"imperative-api"}),this.setState(o)}}componentDidCatch(e,t){var i,n;null===(i=(n=this.props).onError)||void 0===i||i.call(n,e,t)}componentDidUpdate(e,t){let{didCatch:i}=this.state,{resetKeys:n}=this.props;if(i&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,i)=>!Object.is(e,t[i]))}(e.resetKeys,n)){var r,a;null===(r=(a=this.props).onReset)||void 0===r||r.call(a,{next:n,prev:e.resetKeys,reason:"keys"}),this.setState(o)}}render(){let{children:e,fallbackRender:t,FallbackComponent:i,fallback:o}=this.props,{didCatch:a,error:d}=this.state,s=e;if(a){let e={error:d,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(i)s=(0,n.createElement)(i,e);else if(null===o||(0,n.isValidElement)(o))s=o;else throw d}return(0,n.createElement)(r.Provider,{value:{didCatch:a,error:d,resetErrorBoundary:this.resetErrorBoundary}},s)}}},917599:function(e,t,i){i.d(t,{P:function(){return r}});var n,r=((n={})[n.Eager=0]="Eager",n[n.Idle=1]="Idle",n)},451733:function(e,t,i){i.d(t,{$T:function(){return a},$l:function(){return s},Bh:function(){return d},HX:function(){return o},Jo:function(){return r},bK:function(){return u},e8:function(){return c},f3:function(){return p},ht:function(){return l},lq:function(){return n}});var n=["image/jpeg","image/jpg","image/png","image/bmp","image/webp",".jpeg",".jpg",".png",".bmp",".webp"],r=20,o=["video/quicktime","video/x-msvideo","video/avi","video/x-m4v","video/x-flv","video/x-matroska","application/vnd.rn-realmedia-vbr",".mp4",".mov",".avi",".m4v",".flv",".mkv",".rmvb"],a=50,d=["image/jpeg","image/jpg","image/png",".jpeg",".jpg",".png"],s=["video/mp4","video/quicktime",".mp4",".mov"],l=["image/jpeg","image/jpg","image/png",".jpeg",".jpg",".png"],u=["video/mp4","video/quicktime",".mp4",".mov"],c=3e3,p=4096},409625:function(e,t,i){i.d(t,{L_:function(){return n},U7:function(){return d},iE:function(){return a},i_:function(){return o},v2:function(){return r}});var n="GET_FEED_JSONP",r="GET_WEEKLY_JSONP",o="COMMUNITY_FETCH_COMMUNITY_PANEL",a="COMMUNITY_PRELOAD_DEFAULT_COMMUNITY_FEED_LIST",d="COMMUNITY_GET_DEFAULT_COMMUNITY_FEED_LIST"},241047:function(e,t,i){i.d(t,{GT:function(){return c},JI:function(){return a},UN:function(){return u},Zc:function(){return o},fk:function(){return s},iV:function(){return d},qs:function(){return l}});var n,r=i(902519),o={firstTimeFetchCount:20,count:40,panel:"image_aigc"},a={count:40,panel:"dreamina_test_area"},d={count:60},s={[r.Ym.Template]:[r.PK.SINGLE_AND_COLLECTION,r.PK.VIDEO,r.PK.CANVAS_PRODUCTION],[r.Ym.Story]:[r.PK.MASTERPIECE]},l=1006;var u=((n={}).Publish="publish",n.Delete="delete",n),c=2e3},949057:function(e,t,i){i.d(t,{B9:function(){return d},FN:function(){return r},Fy:function(){return o},lo:function(){return a}});var n=i(218571),r=n.createContext({isOverSea:!1,buildRegion:"sg"}),o=n.createContext({assetManager:void 0,boxSelectionManager:void 0}),a=n.createContext({dsrDownloadManager:void 0}),d=n.createContext({dsrManager:void 0})},586961:function(e,t,i){i.d(t,{wU:()=>V,Jg:()=>U,yL:()=>w,cU:()=>B,Kv:()=>P,ve:()=>F,m4:()=>J,Km:()=>N,ZS:()=>K,Gs:()=>H,sG:()=>O,z2:()=>W,K$:()=>M,sI:()=>j,IZ:()=>E,i3:()=>b,X$:()=>R,Ls:()=>L});var n,r,o,a=i("876826"),d=i("85728"),s=i("929753"),l=i("584072"),u=i("216342"),c=i("836413"),p=i("369617"),v=i("150615"),m=i("229025"),g=i("243302"),f=i("283349"),I=i("898387"),y=i("475578"),h=i("379311");class T{getEventParams(){var{status:e,duration:t,resource_type:i,history_group_key_md5:n,submit_id:r,err_msg:o}=this._params;return{status:e,duration:t,err_msg:o,history_group_key_md5:n,resource_type:i,submit_id:r}}constructor(e){this._params=e,this.eventName="websocket_md5_received"}}function A(e,t){(0,h.S$)(e,T,[t])}var _=i("608358"),C=i("331480"),G=i("417699"),D=i("898758");class S{getEventParams(){var{pictureType:e,recordId:t}=this._params;return{picture_type:e,record_id:t}}constructor(e){this._params=e,this.eventName="return_icon_click"}}var k=(e,t)=>new Promise(i=>{t.updateHighlightRecordId(e),setTimeout(()=>{t.updateHighlightRecordId(""),i()},1100)});var P=(0,u.Tx)("record-list-util",(n=(0,a._)(function*(e,t){var{historyRecordId:i,historyGroupKeyMd5:n,instance:r,listContainerRef:o,containerService:a,ignoreWarning:d}=t,s=!d,l="result_toast_abnormal_retry",u="Something went wrong. Try again later.",c=null==o?void 0:o.current,m=(e,t,o)=>{if(!!a)(0,I.j)(a,{status:e,type:"locate",filter_type:(null==r?void 0:r.isGroupView)?"group":"timeline",duration:t,err_msg:o,extra:JSON.stringify({historyRecordId:i,historyGroupKeyMd5:n})})},g=Date.now();if(!r||!c||!i){m("error",Date.now()-g,"locate_params_error"),s&&p.s.warning(v.oc.t(l,{},u));return}var f=r.getRecordIndex(i,n);if(-1!==f)m("success",Date.now()-g,"locate_existed_success"),console.log("[record-list] locates a existing record ",i,f),setTimeout(()=>{c.scrollToItemByIndex(f),k(i,r)},50);else{console.log("[record-list] non-local element, locate remote data ",i);var y=yield null==r?void 0:r.locateContent(e,i,n),h=r.getRecordIndex(i,n);if(!y.ok||-1===h){var T=!y.ok;m("error",Date.now()-g,T?"locate_remote_fetch_error":"locate_remote_index_error");var A=T?v.oc.t(l,{},u):v.oc.t("errorcode_show",{},"The image has been deleted");s&&p.s.warning(A)}else m("success",Date.now()-g,"locate_remote_success"),c.execInNextRender(()=>{setTimeout(()=>{c.scrollToItemByIndex(h),k(i,r)},50)},r.displayRangeId)}}),function(e,t){return n.apply(this,arguments)}),"locateRecord"),x=e=>{if(!e)return console.error("%c[record-list] record should not be nullish value","color: red;",e),"";var{id:t}=e;return t},E=e=>"record-".concat(x(e));var R=(0,u.Tx)("record-list-util",(r=(0,a._)(function*(e,t,i,n,r){var{record:o}=t,{originRecord:a}=o,{historyRecordId:d="",itemList:s=[]}=null!=a?a:{};if(d){var l,u,c=s.length>1?y.ry.thumbnail:y.ry.upscale;l=i,u={pictureType:c,recordId:d},(0,h.Kl)(l,S,[u])}yield P(e,{historyRecordId:d,historyGroupKeyMd5:o.historyGroupKeyMd5,instance:n,listContainerRef:r,containerService:i})}),function(e,t,i,n,o){return r.apply(this,arguments)}),"handleRecordLocateRecord"),b=(e,t)=>{var{hasSyncLastPageDataToGenerateContentListSucceed:i}=e;!function(e,t){var i=e.current;if(!!i)i.scrollToStart(t)}(t,!i)},F=e=>(0,s._)((0,d._)({},e),{createdTime:(0,m.Qd)(e.createdTime),sortCreateTime:(0,m.Qd)(e.sortCreateTime)}),U=e=>"object"==typeof e&&null!==e&&"list"in e,w=e=>Array.isArray(e)&&U(null==e?void 0:e[0]);function M(e){var t,i;return!!((null==e?void 0:null===(t=e.i2vOpt)||void 0===t?void 0:t.realmanAvatar)||(null==e?void 0:null===(i=e.v2vOpt)||void 0===i?void 0:i.lipSyncUserVideo))}function O(e){var t;return!!(null==e?void 0:null===(t=e.v2vOpt)||void 0===t?void 0:t.videoTemplate)}function N(e){var t;return!!(null==e?void 0:null===(t=e.i2vOpt)||void 0===t?void 0:t.realmanAvatar)}var L=e=>[g.pi.Text2Song,g.pi.Text2Instrumental].includes(e),V=e=>!(0,f.w)(e)&&!L(e),B=e=>(0,f.w)(e.generateType),W=e=>L(e.generateType),K=e=>V(e.generateType),j=e=>void 0!==e.draftId&&void 0!==e.storyId&&void 0!==e.storyVersion,H=e=>void 0!==e.id&&void 0!==e.packageId;var J=(o=(0,a._)(function*(e){var{containerService:t,submitId:i,type:n}=e,r=Date.now(),o=(0,_.ko)(t,C.Dx),a=(0,_.ko)(t,G.e),{promise:d,resolve:s,reject:u}=(0,l.PQ)(),p=null,v=a.isOversea?3e3:2e3,m=o.registerEventHandler(C.Te.GroupKeyGenerated,e=>{Date.now(),A(t,{status:"success",duration:Date.now()-r,submit_id:i,history_group_key_md5:e.historyGroupKeyMd5,err_msg:JSON.stringify(e),resource_type:n}),e.submitId===i&&(p&&clearTimeout(p),m.dispose(),s((0,c.oW)({submitId:i,historyGroupKeyMd5:e.historyGroupKeyMd5,isMockMd5:!1})))});return p=setTimeout(()=>{m.dispose();var e=(0,D.V)();A(t,{status:"timeout_error",duration:Date.now()-r,submit_id:i,history_group_key_md5:e,resource_type:n}),p&&clearTimeout(p),s((0,c.oW)({submitId:i,historyGroupKeyMd5:e,isMockMd5:!0}))},v),yield d}),function(e){return o.apply(this,arguments)})},719494:function(e,t,i){function n(e,t,i){var n=e.split(t).map(e=>e.trim());return n.length>1?n.join(i):e}function r(e,t){return e.length>t?"".concat(e.slice(0,t),"..."):e}function o(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===e.length)return"".concat(t," 1");var r=new RegExp("".concat(t,"\\s+(\\d+)")),o=Math.min(i,Math.max(...e.map(e=>{var t=e.match(r);return t?parseInt(t[1],10):0}))+n+1);return"".concat(t," ").concat(o)}i.d(t,{Lr:function(){return r},WY:function(){return o},ZX:function(){return n}})},339128:function(e,t,i){i.d(t,{d$:function(){return s},tF:function(){return d}});var n,r=i(843698),o=i(874800),a=i(836413);var d=((n={}).Init="Init",n.Generating="Generating",n.Success="Success",n.Fail="Fail",n.CanRetry="CanRetry",n);class s extends o.JT{delete(){return this._onDidDelete.fire(),this.dispose(),Promise.resolve((0,a.ly)())}constructor(...e){super(...e),this._onDidDelete=this._store.add(new r.Q),this.onDidDelete=this._onDidDelete.event,this._onDidPolling=this._store.add(new r.Q),this.onDidPolling=this._onDidPolling.event,this._onGenerateSuccess=this._store.add(new r.Q),this.onGenerateSuccess=this._onGenerateSuccess.event,this._onGenerateFailure=this._store.add(new r.Q),this.onGenerateFailure=this._onGenerateFailure.event,this._onModelChange=this._store.add(new r.Q),this.onModelChange=this._onModelChange.event,this._onFavoriteChange=this._store.add(new r.Q),this.onFavoriteChange=this._onFavoriteChange.event}}},613983:function(e,t,i){i.d(t,{IU:function(){return s},Qp:function(){return l},kP:function(){return u},pO:function(){return d}});var n,r,o,a,d=((n={})[n.GenerateVideo=0]="GenerateVideo",n[n.LipSync=1]="LipSync",n);var s=((r={}).init="init",r.uploading="uploading",r.complete="complete",r);var l=((o={}).lastFrame="lastFrame",o.firstFrame="firstFrame",o);var u=((a={}).frame="frame",a.custom="custom",a)},761615:function(e,t,i){i.d(t,{Gd:function(){return C},Mv:function(){return _},i5:function(){return f},od:function(){return A},py:function(){return h},uz:function(){return I}});var n=i(876826),r=i(85728),o=i(929753),a=i(586961),d=i(608358),s=i(369617),l=i(738210),u=i(521950),c=i(229025),p=i(166320),v=i(150615),m=i(260963),g="favorite_toast_id",f=e=>{var{curIdItem:t,record:i,hasFavorited:n,storeService:r}=e;if(!!i){if((null===(o=t.itemIdList)||void 0===o?void 0:o.length)&&(0,a.ZS)(i)&&(0,c.FO)(i)){var o,d,s,l=[...null!==(s=null===(d=i.assetOption)||void 0===d?void 0:d.favoriteItemIdList)&&void 0!==s?s:[]];t.itemIdList.forEach(e=>{var t=l.indexOf(e);n?-1===t&&l.push(e):-1!==t&&l.splice(t,1)}),(0,m.z)(()=>{i.assetOption?(i.assetOption.hasFavorited=!!l.length,i.assetOption.favoriteItemIdList=l):i.assetOption={hasFavorited:!!l.length,favoriteItemIdList:l}})}else(0,m.z)(()=>{i.assetOption?i.assetOption.hasFavorited=n:i.assetOption={hasFavorited:n}});if((0,a.cU)(i)){var u=r.getVideoTaskById(i.id);null==u||u.markFavorite(n)}if((0,a.z2)(i)){var p=r.getAudioTaskById(i.id);null==p||p.markFavorite(n)}}};function I(e){return y.apply(this,arguments)}function y(){return(y=(0,n._)(function*(e){var{service:t,containerService:i,ids:n,hasFavorited:r,onSuccess:o,onError:a}=e,u=(0,d.ko)(i,l.u),c=r?v.ZP.t("assets_toast_favourite_success",{},"Added to Favorites"):v.ZP.t("assets_toast_unfavourite_success",{},"Removed from Favorites"),m=r?v.ZP.t("assets_toast_favourite_fail",{},"Couldn\u2019t add to Favorites. Try again later."):v.ZP.t("assets_toast_unfavourite_fail",{},"Couldn\u2019t remove from Favorites. Try again later."),I=!1,y=[];try{var h,T=yield t.markFavorite({ids:n,favoriteOp:r?p.ie.FavoriteOpLike:p.ie.FavoriteOpUnLike}),A=T.ok&&T.value.every(e=>(null==e?void 0:e.status)&&[p.o$.Failed,p.o$.InvalidAsset].includes(e.status));T.ok&&(null===(h=T.value)||void 0===h?void 0:h.length)&&!A?(T.value.forEach(e=>{var{id:t,status:i}=e;i===p.o$.Success&&(y.push(String(t)),s.s.success({id:g,content:c}))}),I=y.length>0):(null==a||a(),s.s.error({id:g,content:m}))}catch(e){null==a||a(),s.s.error({id:g,content:m})}if(I){for(var _ of n){if(!!_.id&&!!y.includes(_.id)){var C=u.getUnifiedRecordById(_.id);f({curIdItem:_,storeService:u,record:C,hasFavorited:r})}}null==o||o(y)}else null==a||a(),s.s.error({id:g,content:m})})).apply(this,arguments)}function h(e){var{ids:t,recordList:i,hasFavorited:n}=e,a=[];if(!t.length||!i.length)return{hasChanged:!1,resRecordList:i,markedRecordList:a};var d=[...t];return{hasChanged:!0,resRecordList:i.map(e=>{var t=d.findIndex(t=>t.id===e.historyRecordId);if(-1===t)return e;var i=d.splice(t,1)[0],s=(0,u.I)(e);if((null===(l=i.itemIdList)||void 0===l?void 0:l.length)&&(0,c.FO)(s)){var l,p,v,m,g=[...null!==(m=null===(v=s.assetOption)||void 0===v?void 0:v.favoriteItemIdList)&&void 0!==m?m:[]];i.itemIdList.forEach(e=>{var t=g.indexOf(e);n?-1===t&&g.push(e):-1!==t&&g.splice(t,1)}),p={hasFavorited:!!g.length,favoriteItemIdList:g}}else p={hasFavorited:n};var f=(0,o._)((0,r._)({},s),{assetOption:(0,r._)({},s.assetOption,p)});return a.push(f),f}),markedRecordList:a}}var T=e=>{var t;return null===(t=e.assetOption)||void 0===t?void 0:t.hasFavorited};function A(e){return e.recordList.filter(e=>T(e))}function _(e){var t,i,n,r,o,d,{record:s,imageItemId:l=""}=e;if(!(null===(t=s.assetOption)||void 0===t?void 0:t.hasFavorited))return!1;if((0,a.ZS)(s)&&l){;if(null==s?void 0:null===(r=s.assetOption)||void 0===r?void 0:null===(n=r.favoriteItemIdList)||void 0===n?void 0:n.includes(l))return!0;if(null==s?void 0:null===(d=s.assetOption)||void 0===d?void 0:null===(o=d.favoriteItemIdList)||void 0===o?void 0:o.length)return!1}return!!(null===(i=s.assetOption)||void 0===i?void 0:i.hasFavorited)}function C(e,t){return e.map(e=>{var{record:i,itemIdList:n=[]}=e;return(0,c.FO)(i)?{id:i.historyRecordId,type:t,itemIdList:[...n]}:{id:i.historyRecordId,type:t}})}},127364:function(e,t,i){i.d(t,{e:function(){return r}});var n,r=((n={}).AIGCModeWorkbench="workbench",n.AIGCModeCanvas="canvas",n.AIGCModeStory="story",n.AIGCModeCharacter="character",n.AIGCModeAIGCDraft="aigc_draft",n)},99123:function(e,t,i){i.d(t,{FT:function(){return v},hw:function(){return m},lt:function(){return p},q:function(){return c}});var n=i(85728),r=i(379311),o=i(773820),a=i(591586),d=i(243302),s={dreamina_ic_generate_video_model_vgfm_lite:"\u89C6\u9891 S2.0","dreamina_ic_generate_video_model_vgfm1.0":"\u89C6\u9891 S2.0 Pro","dreamina_ailab_generate_video_model_v1.2":"\u89C6\u9891 1.2","dreamina_ailab_generate_video_model_v1.4":"\u89C6\u9891 P2.0 Pro"};class l{getEventParams(){var e,t,i,n,{data:r,status:a,duration:d,taskDuration:l,serverDuration:u,generateDuration:c,taskError:p,generateTaskStatus:v,taskId:m,mode:g,generateType:f,server2WebsocketDuration:I,failCode:y}=this._params,h=null===(e=r.inputImages)||void 0===e?void 0:e[0],T=null===(t=r.inputImages)||void 0===t?void 0:t[1];"taskFail"===a&&(null==p?void 0:p.code)?i="".concat(p.code):"fail"===a&&(i="".concat(v));var A=r.extra,_=null!==(n=null==A?void 0:A.promptSource)&&void 0!==n?n:o.K.Custom;return{video_duration:r.originDurationMs,fps:r.originFps,generate_type:f,prompt_source:_,model_key:r.modelReqKey,model_name:r.modelReqKey?s[r.modelReqKey]:void 0,motion_speed:"".concat(r.motionSpeed),motion_type:r.motionType,seed:"".concat(r.seed),video_ratio:r.videoRatio,video_generate_type:(null==h?void 0:h.imageUri)?2:1,first_frame_image_url:null==h?void 0:h.imageUrl,first_frame_image_uri:null==h?void 0:h.imageUri,last_frame_image_url:null==T?void 0:T.imageUrl,last_frame_image_uri:null==T?void 0:T.imageUri,text_prompt:r.textPrompt,task_duration:l,generate_duration:c,duration:d,server_duration:u,client_duration:d-u,server_to_websocket_duration:I,status:a,fail_code:i,task_fail_code:y,fail_reason:null==p?void 0:p.msg,task_id:m,mode:g,logId:this._logId}}constructor(e,t){this._params=e,this._logId=t,this.eventName="perf_ai_video_generate"}}class u{static getInstance(){return!u._instance&&(u._instance=new u),u._instance}updateTaskRecord(e,t){this._taskRecord[e]=(0,n._)({},this._taskRecord[e],t)}getWebsocketFinishedTime(e){var t;return null===(t=this._taskRecord[e])||void 0===t?void 0:t.websocketFinishedTime}supplementTaskRecord(e,t,i){if(!this._taskRecord[e])this.updateTaskRecord(e,{data:t}),this.markTaskStart(e,i)}markTaskStart(e,t){this.updateTaskRecord(e,{taskStartTime:null!=t?t:Date.now()})}markTaskEnd(e){if(!(null===(t=this._taskRecord[e])||void 0===t?void 0:t.taskStartTime)){a.t.warn("markTaskStart first");return}var t,i=Date.now();this.updateTaskRecord(e,{taskDuration:i-this._taskRecord[e].taskStartTime,generateStartTime:i})}markGenerateEnd(e){var t=this._taskRecord[e],i=Date.now();if(!(null==t?void 0:t.taskStartTime)){a.t.warn("markTaskStart first");return}this.updateTaskRecord(e,{generateDuration:t.generateStartTime?i-t.generateStartTime:-1,duration:i-t.taskStartTime})}report(e,t,i){if(!!this._taskRecord[t])(0,r.Kl)(e,l,[this._taskRecord[t],i]),this._deleteRecord(t)}_deleteRecord(e){this._taskRecord[e]&&delete this._taskRecord[e]}constructor(){this._taskRecord={}}}function c(e){u.getInstance().updateTaskRecord(e,{websocketFinishedTime:Date.now()})}function p(e,t,i,n){u.getInstance().updateTaskRecord(e,{data:t,mode:i,generateType:n}),u.getInstance().markTaskStart(e)}function v(e,t,i,n,r){var o,{createdTime:a,task:s,generateType:l,failCode:c}=t,{submitId:p,status:v,taskId:m,finishTime:g}=s;if(r&&(u.getInstance().supplementTaskRecord(p,r,r.createdTime),u.getInstance().updateTaskRecord(p,{mode:i,generateType:l})),m&&u.getInstance().updateTaskRecord(p,{taskId:m}),v===d.Pd.SubmitOk)u.getInstance().markTaskEnd(p);else{;if(o=v,[d.Pd.FinalSuccess,d.Pd.FinalGenerateFail,d.Pd.PreTnsCheckNotPass,d.Pd.PostTnsCheckNotPass].includes(o)){var f=u.getInstance().getWebsocketFinishedTime(p);u.getInstance().markGenerateEnd(p),u.getInstance().updateTaskRecord(p,{status:v===d.Pd.FinalSuccess?"success":"fail",generateTaskStatus:v,serverDuration:1e3*g-a,server2WebsocketDuration:f?f-1e3*g:void 0,failCode:c}),u.getInstance().report(e,p,n)}}}function m(e,t,i){if(u.getInstance().markTaskEnd(t),!i.ok){var n,[r]=i.pair();u.getInstance().updateTaskRecord(t,{status:"taskFail",taskError:r}),u.getInstance().report(e,t,null===(n=i.errorInfo)||void 0===n?void 0:n.logId)}}},114527:function(e,t,i){i.d(t,{$:function(){return a},K:function(){return d}});var n=i(379311);class r{getEventParams(){var{cost:e,assetType:t}=this._params;return{cost:e,asset_type:t}}constructor(e){this._params=e,this.eventName="get_history_time_consuming"}}class o{getEventParams(){var{cost:e,assetType:t}=this._params;return{cost:e,asset_type:t}}constructor(e){this._params=e,this.eventName="get_asset_list_time_consuming"}}function a(e,t){(0,n.S$)(e,r,[t])}function d(e,t){(0,n.S$)(e,o,[t])}},898387:function(e,t,i){i.d(t,{j:function(){return o}});var n=i(379311);class r{getEventParams(){var{status:e,duration:t,err_msg:i,type:n,filter_type:r,extra:o}=this._params;return{status:e,duration:t,err_msg:i,type:n,filter_type:r,extra:o}}constructor(e){this._params=e,this.eventName="record_list_performance"}}function o(e,t){(0,n.S$)(e,r,[t])}},740242:function(e,t,i){i.d(t,{bY:function(){return l},dz:function(){return s},k$:function(){return d}});var n=i(379311);class r{getEventParams(){var{msg:e}=this._params;return{msg:e}}constructor(e){this._params=e,this.eventName="websocket-error"}}class o{getEventParams(){var{taskName:e,taskId:t,submitId:i,reason:n}=this._params;return{taskName:e,taskId:t,submitId:i,reason:n}}constructor(e){this._params=e,this.eventName="websocket-fallback-to-polling"}}class a{getEventParams(){var{taskName:e,taskId:t,submitId:i,taskStatus:n,duration:r}=this._params;return{taskName:e,taskId:t,submitId:i,taskStatus:n,duration:r}}constructor(e){this._params=e,this.eventName="websocket-aigc-done-msg"}}function d(e,t){(0,n.US)(e,r,[t])}function s(e,t){(0,n.US)(e,o,[t])}function l(e,t){(0,n.US)(e,a,[t])}},104818:function(e,t,i){i.d(t,{P:function(){return n}});var n=(0,i(971245).yh)("get-content-generation-history-service")},216475:function(e,t,i){i.d(t,{B:function(){return o},D:function(){return r}});var n=i(168179);function r(e){var t=new n.DABlendPromptPlaceHolderInfo;return t.abilityIndex=e.abilityIndex,t}function o(e){var t;return{abilityIndex:null!==(t=e.abilityIndex)&&void 0!==t?t:0}}},375516:function(e,t,i){i.d(t,{J:function(){return a},a:function(){return o}});var n=i(168179),r=i(716467);function o(e){var t=new n.DACommonAssetResource;return t.assetType=r.d6[e.assetType],t.assetCode=e.assetCode,t}function a(e,t){var i,n,o=null==t?void 0:null===(n=t.find(t=>t.key===e.assetCode))||void 0===n?void 0:null===(i=n.assetInfo)||void 0===i?void 0:i.referImageList;return{assetType:r.H[e.assetType],assetCode:e.assetCode,referImageList:o}}},464369:function(e,t,i){i.d(t,{F:function(){return o},_:function(){return r}});var n=i(168179);function r(e){var t=new n.DAImageControlNet;return t.name=e.name,t.strength=e.strength,t.imageIndex=e.imageIndex,t.maskIndex=e.maskIndex,t}function o(e){var t;if(!!e.name)return{name:e.name,strength:e.strength,imageIndex:null!==(t=e.imageIndex)&&void 0!==t?t:0,maskIndex:e.maskIndex}}},541177:function(e,t,i){i.d(t,{M:function(){return o},f:function(){return r}});var n=i(168179);function r(e){if(!!e){var t=new n.DAEverPhoto;return t.workspaceId=e.workspaceId,t.assetId=e.assetId,t}}function o(e){if(!!e)return{workspaceId:e.workspaceId,assetId:e.assetId}}},595743:function(e,t,i){i.d(t,{X:function(){return r},b:function(){return o}});var n=i(168179);function r(e){var t=new n.DAImageFaceRecognize;return t.keypoint=null==e?void 0:e.keypoint,t.faceRect=null==e?void 0:e.faceRect,t.isSelected=null==e?void 0:e.isSelected,t}function o(e){var t,i;return{keypoint:null!==(t=null==e?void 0:e.keypoint)&&void 0!==t?t:[],faceRect:null!==(i=null==e?void 0:e.faceRect)&&void 0!==i?i:[],isSelected:!!(null==e?void 0:e.isSelected)}}},650078:function(e,t,i){i.d(t,{M:function(){return a},w:function(){return o}});var n=i(168179),r=i(541177);function o(e){if(!!e){var t,i,o,a=new n.DAImageResource;return a.sourceFrom=n.DAResourceSourceFrom.upload,a.platformType=n.DAImageResourcePlatformType.imageX,a.uri=e.imageUri,a.width=null!==(t=e.width)&&void 0!==t?t:0,a.height=null!==(i=e.height)&&void 0!==i?i:0,a.format=null!==(o=e.format)&&void 0!==o?o:"",a.everPhoto=(0,r.f)(e.everPhoto),a}}function a(e,t){if(!!(null==e?void 0:e.uri)){var i,n,o,a,d,s=null==t?void 0:null===(i=t.find(t=>t.key===e.uri))||void 0===i?void 0:i.imageInfo;return{imageUri:e.uri,imageUrl:null==s?void 0:s.imageUrl,width:null!==(n=null==s?void 0:s.width)&&void 0!==n?n:e.width,height:null!==(o=null==s?void 0:s.height)&&void 0!==o?o:e.height,format:null!==(a=null==s?void 0:s.format)&&void 0!==a?a:e.format,everPhoto:null!==(d=null==s?void 0:s.everPhoto)&&void 0!==d?d:(0,r.M)(e.everPhoto),coverUrlMap:null==s?void 0:s.coverUrlMap}}}},501385:function(e,t,i){i.d(t,{J:function(){return o},V:function(){return r}});var n=i(168179);function r(e){var t=new n.DAImageIpKeep;return t.description=e.description,t.refIdWeight=e.refIdWeight,t.refIpWeight=e.refIpWeight,t.characterId=e.characterId,t.characterName=e.characterName,t}function o(e){var t,i,n,r,o;return{description:null!==(t=e.description)&&void 0!==t?t:"",refIdWeight:null!==(i=e.refIdWeight)&&void 0!==i?i:0,refIpWeight:null!==(n=e.refIpWeight)&&void 0!==n?n:0,characterId:String(null!==(r=e.characterId)&&void 0!==r?r:"0"),characterName:null!==(o=e.characterName)&&void 0!==o?o:""}}},476928:function(e,t,i){i.d(t,{_:function(){return a},t:function(){return d}});var n=i(168179),r=i(650078),o=i(716467);function a(e){var t=new n.DAImageStyleReference;return t.styleWeight=e.styleWeight,t.styleItemId=e.styleItemId,t.styleTitle=e.styleTitle,t.styleTitleStarlingKey=e.styleTitleStarlingKey,t.styleType=e.styleType&&o.ed[e.styleType],t.image=(0,r.w)(e.image),t}function d(e,t){var i,n;return{styleWeight:null!==(i=e.styleWeight)&&void 0!==i?i:0,styleItemId:e.styleItemId,styleTitle:e.styleTitle,styleTitleStarlingKey:e.styleTitleStarlingKey,styleType:e.styleType&&o.BH[e.styleType],image:null!==(n=(0,r.M)(e.image,t))&&void 0!==n?n:{}}}},716467:function(e,t,i){i.d(t,{MD:()=>I,ed:()=>y,H:()=>k,db:()=>A,BH:()=>h,sc:()=>g,Zv:()=>D,$p:()=>f,uC:()=>C,d6:()=>S,CB:()=>T,nA:()=>G,Di:()=>_});var n,r=i("339128"),o=i("127364");var a=((n={}).BgPaint="bg_paint",n.Face="face",n.Ip="ip",n.StyleReference="style_reference",n.Canny="canny",n.Depth="depth",n.Pose="pose",n),d=i("128468"),s=i("243302"),l=i("955625"),u=i("100470"),c=i("417281"),p=i("749314"),v=i("224671"),m=i("168179");o.e.AIGCModeWorkbench,d.JU.Workbench,o.e.AIGCModeAIGCDraft,d.JU.AIGCDraft,o.e.AIGCModeCanvas,d.JU.Canvas,o.e.AIGCModeCharacter,d.JU.Character,o.e.AIGCModeStory,d.JU.Story;var g={[d.JU.Workbench]:m.DAAIGCMode.workbench,[d.JU.Canvas]:m.DAAIGCMode.canvas,[d.JU.Character]:m.DAAIGCMode.character,[d.JU.Story]:m.DAAIGCMode.story,[d.JU.AIGCDraft]:m.DAAIGCMode.aigcDraft,[d.JU.PostEditor]:m.DAAIGCMode.postEditor},f={[m.DAAIGCMode.none]:d.JU.Workbench,[m.DAAIGCMode.workbench]:d.JU.Workbench,[m.DAAIGCMode.canvas]:d.JU.Canvas,[m.DAAIGCMode.character]:d.JU.Character,[m.DAAIGCMode.story]:d.JU.Story,[m.DAAIGCMode.aigcDraft]:d.JU.AIGCDraft,[m.DAAIGCMode.postEditor]:d.JU.PostEditor};r.tF.Init,s.Pd.Init,r.tF.Fail,s.Pd.PreTnsCheckNotPass,r.tF.Generating,s.Pd.SubmitOk,r.tF.Success,s.Pd.FinalSuccess,r.tF.CanRetry,s.Pd.FinalGenerateFail;var I={[l.l.OutputImageRisk]:u.b.ErrPreImgRiskNotPass,[l.l.InputTextRisk]:u.b.ErrPreTextRiskNotPass,[l.l.InputTextIpBlock]:u.b.ErrPreTextIPBlockList,[l.l.GenerateFail]:u.b.ErrGenerate,[l.l.RateLimit1]:u.b.ErrRateLimit,[l.l.UnsupportedByBeta]:u.b.ErrUnsupportedByBeta,[l.l.ErrParam]:u.b.ErrParam,[l.l.ErrPostImgRiskNotPass]:u.b.ErrPostImgRiskNotPass,[l.l.ErrDownloadImage]:u.b.ErrDownloadImage,[l.l.ErrSuccess]:u.b.ErrSuccess,[l.l.ErrAssetsCodeNotExist]:u.b.ErrAssetsCodeNotExist,[l.l.ErrAssetsStatusInvalid]:u.b.ErrAssetsStatusInvalid};u.b.ErrPreImgRiskNotPass,l.l.OutputImageRisk,u.b.ErrPreTextRiskNotPass,l.l.InputTextRisk,u.b.ErrPreTextIPBlockList,l.l.InputTextIpBlock,u.b.ErrGenerate,l.l.GenerateFail,u.b.ErrRateLimit,l.l.RateLimit1,u.b.ErrUnsupportedByBeta,l.l.UnsupportedByBeta,u.b.ErrParam,l.l.ErrParam,u.b.ErrDownloadImage,l.l.ErrDownloadImage,u.b.ErrSuccess,l.l.ErrSuccess,u.b.ErrPostImgRiskNotPass,l.l.ErrPostImgRiskNotPass,c.kR.ControlNetPose,a.Pose,c.kR.ControlNetDepth,a.Depth,c.kR.ControlNetCanny,a.Canny,c.kR.ControlNetBgPaint,a.BgPaint;var y={[p.l.Preset]:m.DAImageStyleStyleType.Default,[p.l.Custom]:m.DAImageStyleStyleType.Customize},h={[m.DAImageStyleStyleType.Default]:p.l.Preset,[m.DAImageStyleStyleType.Customize]:p.l.Custom},T={[v.jP.OneOne]:m.DAImageRatioType.ImageRatioType_11,[v.jP.ThreeFour]:m.DAImageRatioType.ImageRatioType_34,[v.jP.FourThree]:m.DAImageRatioType.ImageRatioType_43,[v.jP.NineSixteen]:m.DAImageRatioType.ImageRatioType_916,[v.jP.SixteenNine]:m.DAImageRatioType.ImageRatioType_169,[v.jP.TwoThree]:m.DAImageRatioType.ImageRatioType_23,[v.jP.ThreeTwo]:m.DAImageRatioType.ImageRatioType_32,[v.jP.TwentyOneNine]:m.DAImageRatioType.ImageRatioType_219},A={[m.DAImageRatioType.ImageRatioType_11]:v.jP.OneOne,[m.DAImageRatioType.ImageRatioType_34]:v.jP.ThreeFour,[m.DAImageRatioType.ImageRatioType_43]:v.jP.FourThree,[m.DAImageRatioType.ImageRatioType_916]:v.jP.NineSixteen,[m.DAImageRatioType.ImageRatioType_169]:v.jP.SixteenNine,[m.DAImageRatioType.ImageRatioType_23]:v.jP.TwoThree,[m.DAImageRatioType.ImageRatioType_32]:v.jP.ThreeTwo,[m.DAImageRatioType.ImageRatioType_219]:v.jP.TwentyOneNine},_={[c.UI.FaceGan]:m.DABlendAbilityName.FaceGan,[c.UI.BgPaint]:m.DABlendAbilityName.BgPaint,[c.UI.Image2image]:m.DABlendAbilityName.I2I,[c.UI.ControlNet]:m.DABlendAbilityName.ControlNet,[c.UI.StyleReference]:m.DABlendAbilityName.StyleReference,[c.UI.IpKeep]:m.DABlendAbilityName.IpKeep,[c.UI.Unknown]:m.DABlendAbilityName.Unknown,[c.UI.Text2image]:m.DABlendAbilityName.T2I,[c.UI.ByteEdit]:m.DABlendAbilityName.ByteEdit,[c.UI.StyleCode]:m.DABlendAbilityName.StyleCode},C={[m.DABlendAbilityName.FaceGan]:c.UI.FaceGan,[m.DABlendAbilityName.BgPaint]:c.UI.BgPaint,[m.DABlendAbilityName.I2I]:c.UI.Image2image,[m.DABlendAbilityName.ControlNet]:c.UI.ControlNet,[m.DABlendAbilityName.StyleReference]:c.UI.StyleReference,[m.DABlendAbilityName.IpKeep]:c.UI.IpKeep,[m.DABlendAbilityName.Unknown]:c.UI.Unknown,[m.DABlendAbilityName.T2I]:c.UI.Text2image,[m.DABlendAbilityName.ByteEdit]:c.UI.ByteEdit,[m.DABlendAbilityName.StyleCode]:c.UI.StyleCode},G={[s.pi.Unknown]:m.DAAIGCGenerateType.none,[s.pi.Text2Image]:m.DAAIGCGenerateType.text2image,[s.pi.SuperResolution]:m.DAAIGCGenerateType.superResolution,[s.pi.FineTunePromptWithText2Image]:m.DAAIGCGenerateType.fineTunePromptWithText2Image,[s.pi.FineTunePromptWithSuperResolution]:m.DAAIGCGenerateType.fineTunePromptWithSuperResolution,[s.pi.Text2CreativeText]:m.DAAIGCGenerateType.text2CreativeTxet,[s.pi.SpecialEffect]:m.DAAIGCGenerateType.specialEffect,[s.pi.InPaint]:m.DAAIGCGenerateType.inPainting,[s.pi.OutPaint]:m.DAAIGCGenerateType.outPainting,[s.pi.InPaintRemove]:m.DAAIGCGenerateType.inPaintingRemove,[s.pi.Text2Video]:m.DAAIGCGenerateType.text2Video,[s.pi.Blend]:m.DAAIGCGenerateType.blend,[s.pi.SuperDefinition]:m.DAAIGCGenerateType.normalHD,[s.pi.Matting]:m.DAAIGCGenerateType.imageCut,[s.pi.Fusion]:m.DAAIGCGenerateType.imageFusion,[s.pi.VideoBGM]:m.DAAIGCGenerateType.videoBGM,[s.pi.AudioVideoMix]:m.DAAIGCGenerateType.audioVideoMix,[s.pi.InstaDrag]:m.DAAIGCGenerateType.instaDrag,[s.pi.Image2Avatar]:m.DAAIGCGenerateType.image2Avatar,[s.pi.Video2Avatar]:m.DAAIGCGenerateType.video2Avatar,[s.pi.Text2Song]:m.DAAIGCGenerateType.text2Song,[s.pi.Text2Instrumental]:m.DAAIGCGenerateType.text2Instrumental,[s.pi.LipSync]:m.DAAIGCGenerateType.lipSync,[s.pi.InPaintAndOutPaint]:m.DAAIGCGenerateType.inPaintingAndOutPainting,[s.pi.ByteEditPainting]:m.DAAIGCGenerateType.byteEditPainting,[s.pi.VideoTemplate]:m.DAAIGCGenerateType.videoTemplate,[s.pi.AIEffectWorkImage]:m.DAAIGCGenerateType.aIEffectWorkImage,[s.pi.AIEffectWorkVideo]:m.DAAIGCGenerateType.aIEffectWorkVideo,[s.pi.VideoAudioEffect]:m.DAAIGCGenerateType.none,[s.pi.VideoAudioEffectMix]:m.DAAIGCGenerateType.none},D={[m.DAAIGCGenerateType.none]:s.pi.Unknown,[m.DAAIGCGenerateType.text2image]:s.pi.Text2Image,[m.DAAIGCGenerateType.superResolution]:s.pi.SuperResolution,[m.DAAIGCGenerateType.fineTunePromptWithText2Image]:s.pi.FineTunePromptWithText2Image,[m.DAAIGCGenerateType.fineTunePromptWithSuperResolution]:s.pi.FineTunePromptWithSuperResolution,[m.DAAIGCGenerateType.text2CreativeTxet]:s.pi.Text2CreativeText,[m.DAAIGCGenerateType.specialEffect]:s.pi.SpecialEffect,[m.DAAIGCGenerateType.inPainting]:s.pi.InPaint,[m.DAAIGCGenerateType.outPainting]:s.pi.OutPaint,[m.DAAIGCGenerateType.inPaintingRemove]:s.pi.InPaintRemove,[m.DAAIGCGenerateType.text2Video]:s.pi.Text2Video,[m.DAAIGCGenerateType.blend]:s.pi.Blend,[m.DAAIGCGenerateType.normalHD]:s.pi.SuperDefinition,[m.DAAIGCGenerateType.imageCut]:s.pi.Matting,[m.DAAIGCGenerateType.imageFusion]:s.pi.Fusion,[m.DAAIGCGenerateType.videoBGM]:s.pi.VideoBGM,[m.DAAIGCGenerateType.audioVideoMix]:s.pi.AudioVideoMix,[m.DAAIGCGenerateType.instaDrag]:s.pi.InstaDrag,[m.DAAIGCGenerateType.image2Avatar]:s.pi.Image2Avatar,[m.DAAIGCGenerateType.video2Avatar]:s.pi.Video2Avatar,[m.DAAIGCGenerateType.text2Song]:s.pi.Text2Song,[m.DAAIGCGenerateType.text2Instrumental]:s.pi.Text2Instrumental,[m.DAAIGCGenerateType.lipSync]:s.pi.LipSync,[m.DAAIGCGenerateType.inPaintingAndOutPainting]:s.pi.InPaintAndOutPaint,[m.DAAIGCGenerateType.byteEditPainting]:s.pi.ByteEditPainting,[m.DAAIGCGenerateType.videoTemplate]:s.pi.VideoTemplate,[m.DAAIGCGenerateType.aIEffectWorkImage]:s.pi.AIEffectWorkImage,[m.DAAIGCGenerateType.aIEffectWorkVideo]:s.pi.AIEffectWorkVideo,[m.DAAIGCGenerateType.videoAudioEffect]:s.pi.VideoAudioEffect},S={[d.d_.Style]:m.DACommonAssetType.Style},k={[m.DACommonAssetType.Style]:d.d_.Style}},902519:function(e,t,i){i.d(t,{PK:function(){return l},Ym:function(){return s},im:function(){return u},lX:function(){return d}});var n,r,o,a,d=((n={}).Post="post",n.Like="like",n);var s=((r={}).Template="template",r.Story="story",r);var l=((o={})[o.IMAGE_SINGLE=1]="IMAGE_SINGLE",o[o.IMAGE_COLLECTION=2]="IMAGE_COLLECTION",o[o.SINGLE_AND_COLLECTION=3]="SINGLE_AND_COLLECTION",o[o.VIDEO=4]="VIDEO",o[o.MASTERPIECE=5]="MASTERPIECE",o[o.MIXED_ROWS=6]="MIXED_ROWS",o[o.CANVAS_PRODUCTION=7]="CANVAS_PRODUCTION",o);var u=((a={})[a.Follow=1]="Follow",a[a.CancelFollow=2]="CancelFollow",a)},566291:function(e,t,i){i.d(t,{Y:function(){return o}});var n=i(799108),r=i(369617),o=e=>{!e.ok&&String(e.code)===n.HR.GenerateViolation&&r.s.warningByThrottle({style:{zIndex:9999},content:e.msg})}},932683:function(e,t,i){i.d(t,{E:function(){return o},N:function(){return a}});var n,r=i(971245);var o=((n={})[n.All=1]="All",n[n.Generate=2]="Generate",n[n.SuperResolution=3]="SuperResolution",n[n.Favoraite=4]="Favoraite",n),a=(0,r.yh)("image-assets-history-service")},738210:function(e,t,i){i.d(t,{u:function(){return n}});var n=(0,i(971245).yh)("record-store-service")},830563:function(e,t,i){i.d(t,{X:function(){return a},l:function(){return o}});var n,r,o=((n={})[n.transcoding=0]="transcoding",n[n.success=1]="success",n[n.fail=2]="fail",n);var a=((r={})[r.Uploading=1]="Uploading",r[r.UploadFailed=2]="UploadFailed",r[r.WaitingForUploading=3]="WaitingForUploading",r[r.UploadSuccess=4]="UploadSuccess",r[r.EncodeSuccess=10]="EncodeSuccess",r[r.EncodeFailed=20]="EncodeFailed",r[r.Encoding=30]="Encoding",r[r.NonExist=40]="NonExist",r)},538638:function(e,t,i){i.d(t,{F:function(){return r}});var n,r=((n={}).ALL="all",n.Favor="favor",n)},955625:function(e,t,i){i.d(t,{J:function(){return a},l:function(){return o}});var n,r,o=((n={}).ErrSuccess="0",n.OutputImageRisk="2039",n.InputTextRisk="2038",n.InputTextIpBlock="2047",n.GenerateFail="2036",n.RateLimit1="1057",n.UnsupportedByBeta="1182",n.ErrParam="1001",n.ErrPreImgRiskNotPass="2039",n.ErrDownloadImage="1059",n.ErrPostImgRiskNotPass="2041",n.ErrAssetsCodeNotExist="1190",n.ErrAssetsStatusInvalid="1189",n);var a=((r={})[r.Unknown=0]="Unknown",r[r.ImageX=1]="ImageX",r[r.VCloud=2]="VCloud",r)},283349:function(e,t,i){i.d(t,{L:function(){return o},w:function(){return r}});var n=i(243302),r=e=>[n.pi.Text2Video,n.pi.VideoBGM,n.pi.AudioVideoMix,n.pi.Image2Avatar,n.pi.Video2Avatar,n.pi.VideoTemplate,n.pi.VideoAudioEffect,n.pi.VideoAudioEffectMix].includes(e),o=e=>[n.pi.Text2Song,n.pi.Text2Instrumental].includes(e)},869409:function(e,t,i){i.d(t,{Q:function(){return a},d:function(){return o}});var n,r,o=((n={})[n.All=0]="All",n[n.Image=1]="Image",n[n.Video=2]="Video",n[n.Story=3]="Story",n[n.Canvas=4]="Canvas",n[n.VideoBGM=5]="VideoBGM",n[n.Audio=6]="Audio",n[n.VideoAudioEffect=7]="VideoAudioEffect",n);var a=((r={})[r.CreateAt=0]="CreateAt",r[r.ModifyAt=1]="ModifyAt",r)},166320:function(e,t,i){i.d(t,{Eu:function(){return a},ie:function(){return d},o$:function(){return s}});var n,r,o,a=((n={})[n.Image=1]="Image",n[n.Video=2]="Video",n[n.Story=3]="Story",n[n.Canvas=4]="Canvas",n[n.VideoBGM=5]="VideoBGM",n[n.Audio=6]="Audio",n[n.VideoAudioEffect=7]="VideoAudioEffect",n[n.VimoItem=100]="VimoItem",n);var d=((r={})[r.FavoriteOpLike=1]="FavoriteOpLike",r[r.FavoriteOpUnLike=2]="FavoriteOpUnLike",r);var s=((o={})[o.Success=0]="Success",o[o.Failed=1]="Failed",o[o.InvalidAsset=2]="InvalidAsset",o)},257843:function(e,t,i){i.d(t,{K:function(){return n}});var n=(0,i(971245).yh)("dreamina-assets-data-service")},882644:function(e,t,i){i.d(t,{w:function(){return a},z:function(){return o}});var n,r,o=((n={})[n.Unknown=0]="Unknown",n[n.AIGCHistory=1]="AIGCHistory",n[n.EverPhoto=2]="EverPhoto",n);var a=((r={})[r.Init=0]="Init",r[r.Fail=30]="Fail",r[r.FinalSuccess=50]="FinalSuccess",r[r.Processing=60]="Processing",r)},657600:function(e,t,i){i.d(t,{_:function(){return n}});var n=(0,i(971245).yh)("dreamina-story-export-materials-data-service")},9156:function(e,t,i){i.d(t,{A:()=>y,n:()=>h});var n=i("971245"),r=i("876826"),o=i("643590"),a=i("804274"),d=i("453604"),s=i("875649"),l=i("604488"),u=i("712942"),c={sg:"https://lf16-beecdn.ibytedtos.com",cn:"https://lf3-beecdn.by".concat(l._8,"etos.com")},p={sg:"/obj/ies-fe-bee-sg/bee_prod/biz_170/bee_prod_170_bee_publish_714.json",cn:"/obj/ies-fe-bee/bee_prod/biz_1521/bee_prod_1521_bee_publish_12992.json"},v=i("836413"),m=i("242089"),g=i("100470");class f{getImcConfig(){var e=this;return(0,r._)(function*(){try{var t,i=(t=(0,u.yA)(),"".concat(c[t]).concat(p[t])),n=yield(0,m.O)(i,()=>e._networkClient.get(i,{params:{needCache:!0}}));return(0,v.oW)(n)}catch(e){var{ret:r,errmsg:o}=e||{},a=r?Number(r):g.b.ErrCommon;return(0,v.wf)(a,null!=o?o:"unknown error")}})()}constructor(){var e;this._networkClient=(e=new o.y().build({headers:{"Content-Type":"application/json"}}),(0,a.xP)(e),(0,d.d)(e),(0,s.e_)(e),e)}}class I{getImcConfigByKey(e){var t=this;return(0,r._)(function*(){var i=yield t._commonConfigRepository.getImcConfig();if(i.ok){var n,r=i.value;if(e&&r)return null!==(n=r[e])&&void 0!==n?n:null}return null})()}constructor(e){this._commonConfigRepository=e}}var y=(0,n.yh)("mWeb-imc-config-service");class h{get repository(){return this._repository}get aggregate(){return this._aggregate}constructor(){this._repository=new f,this._aggregate=new I(this._repository)}}},675601:function(e,t,i){i.d(t,{g:function(){return n}});var n=(0,i(971245).yh)("dreamina-video-generate-data-service")},535823:function(e,t,i){i.d(t,{$q:function(){return R},Lr:function(){return C},ZF:function(){return P},jc:function(){return k}});var n=i(85728),r=i(929753),o=i(820266),a=i(804274),d=i(562092),s=i(869919),l=i(733787),u=i(952739),c=i(243302),p=i(283349),v=i(43169),m=i(56168),g=i(229025),f=i(56935),I=i(168179);function y(e){if(e===I.DAVideoGenerateType.videoTemplate)return s.eA.VideoTemplate}function h(e,t){if(!e)return;var i,r,d=new I.DADraft({JSONString:e}).findMainComponent();if(!d)return;var{abilities:s,generateType:l}=d,u=null==s?void 0:null===(i=s.genVideo)||void 0===i?void 0:i.text2VideoParams;if(!!u){var{videoAspectRatio:c,seed:p}=u;return{videoGenInputs:function(e,t){var i,r,d,s,l,u=JSON.parse(null!==(s=e.toJSONString())&&void 0!==s?s:"{}"),c=(0,o.b)(u.video_gen_inputs,a.zW),{imageInfo:p,videoTemplate:v,videoInfo:m}=null!==(l=null===(r=e.videoGenInputs)||void 0===r?void 0:null===(i=r[0].v2vOpt)||void 0===i?void 0:i.videoTemplate)&&void 0!==l?l:{},g=null===(d=c[0].v2vOpt)||void 0===d?void 0:d.videoTemplate;if(g){var f=function(e,t){if(!!(null==e?void 0:e.uri)){var i,n,r,o,a=null==t?void 0:null===(i=t.find(t=>t.key===e.uri))||void 0===i?void 0:i.imageInfo;return{imageUri:e.uri,imageUrl:null==a?void 0:a.imageUrl,width:null!==(n=null==a?void 0:a.width)&&void 0!==n?n:e.width,height:null!==(r=null==a?void 0:a.height)&&void 0!==r?r:e.height,format:null!==(o=null==a?void 0:a.format)&&void 0!==o?o:e.format,coverUrlMap:null==a?void 0:a.coverUrlMap}}}(p,t),I=function(e,t){var i,r=null==e?void 0:e.vid;if(!!r){var o=null==t?void 0:null===(i=t.find(e=>e.key===r))||void 0===i?void 0:i.videoInfo;return(0,n._)({videoId:r},o)}}(m,t);g.imageInfo=f,g.videoTemplateItemId=v?String(v):void 0,g.videoInfo=I}return c}(u,t),videoAspectRatio:c,seed:p,taskScene:(null==s?void 0:null===(r=s.genVideo)||void 0===r?void 0:r.scene)||y(l)}}}function T(e){return!!e&&"type"in e&&"video_base_component"===e.type}function A(e){if(!e)return!1;var t=new I.DADraft({JSONString:e}).findMainComponent();return!!(t&&T(t))&&t.generateType===I.DAVideoGenerateType.videoTemplate}var _={[I.DAVideoGenerateType.genVideo]:l.v8.VideoGen,[I.DAVideoGenerateType.lipSync]:l.v8.LipSync,[I.DAVideoGenerateType.videoTemplate]:l.v8.VideoTemplate,[I.DAVideoGenerateType.videoAudioEffect]:l.v8.VideoAudioEffect,[I.DAVideoGenerateType.none]:l.v8.VideoGen},C=e=>{var t,i,a,s,l,u,c,p,v=e.originalInput.videoGenInputs[0];return{taskId:"".concat(e.taskId),historyId:"".concat(e.historyId),aid:e.aid,submitId:e.submitId,status:e.status,finishTime:e.finishTime,firstFrameImage:e.firstFrameImage,firstGenerateType:e.firstGenerateType,imageToAvatar:e.imageToAvatar,originalInput:(0,r._)((0,n._)({},e.originalInput),{videoGenInputs:[(0,r._)((0,n._)({},v),{firstFrameImage:(null===(t=v.firstFrameImage)||void 0===t?void 0:t.imageUri)?v.firstFrameImage:void 0,endFrameImage:(null===(i=v.endFrameImage)||void 0===i?void 0:i.imageUri)?v.endFrameImage:void 0,v2vOpt:v.v2vOpt?(0,r._)((0,n._)({},v.v2vOpt),{lipSyncUserVideo:v.v2vOpt.lipSyncUserVideo?(0,r._)((0,n._)({},v.v2vOpt.lipSyncUserVideo),{ttsInfo:(0,o.b)((0,d.D)(v.v2vOpt.lipSyncUserVideo.ttsInfo))}):void 0}):void 0,i2vOpt:v.i2vOpt?(0,r._)((0,n._)({},v.i2vOpt),{realmanAvatar:(null===(a=v.i2vOpt)||void 0===a?void 0:a.realmanAvatar)?(0,r._)((0,n._)({},v.i2vOpt.realmanAvatar),{ttsInfo:(0,o.b)((0,d.D)(v.i2vOpt.realmanAvatar.ttsInfo))}):void 0}):void 0})]}),taskPayload:(0,r._)((0,n._)({},e.taskPayload),{taskExtra:(0,d.D)(null!==(c=null===(s=e.taskPayload)||void 0===s?void 0:s.taskExtra)&&void 0!==c?c:"{}")}),lipSyncInfo:e.lipSyncInfo?(0,r._)((0,n._)({},e.lipSyncInfo),{lipSyncExtra:(0,d.D)(null!==(p=null===(l=e.lipSyncInfo)||void 0===l?void 0:l.lipSyncExtra)&&void 0!==p?p:"")}):void 0,processFlows:e.processFlows,priority:e.priority,videoBGMInfo:(null===(u=e.aigcImageParams)||void 0===u?void 0:u.videoBgmParams)?e.aigcImageParams.videoBgmParams:void 0}},G=e=>{var t;return e.task.firstFrameImage?(0,r._)((0,n._)({},e.task.firstFrameImage),{coverUrlMap:(0,u.fe)(e.task.multiSizeFirstFrameImage)}):(null===(t=e.originItemList)||void 0===t?void 0:t[0])?(0,r._)((0,n._)({},e.originItemList[0]),{imageUri:e.originItemList[0].uri}):{imageUri:"",imageUrl:"",width:0,height:0}},D=e=>e.task.endFrameImage?(0,r._)((0,n._)({},e.task.endFrameImage),{coverUrlMap:(0,u.fe)(e.task.multiSizeEndFrameImage)}):{imageUri:"",imageUrl:"",width:0,height:0};function S(e,t){var i,r=null==e?void 0:null===(i=e.videoGenInputs[0].v2vOpt)||void 0===i?void 0:i.videoTemplate,o=null==t?void 0:t.video;o&&(null==r?void 0:r.videoInfo)&&(r.videoInfo=(0,n._)({},r.videoInfo,o)),r&&t&&(r.videoTemplateItem=t)}function k(e){var t,i=null==e?void 0:null===(t=e.aigc_draft)||void 0===t?void 0:t.content;if(!!i&&!!e&&!!A(i)){var n=h(i,(0,a.fs)(e.aigc_draft_resources,a.zW));S(n,(0,a.fs)(e.video_template_item,a.zW)),e.aigc_image_params.text2video_params=(0,a.fs)(n,a.D1)}}var P=e=>{var t,i,n,r=null===(t=e.itemList)||void 0===t?void 0:t[0];!function(e,t){var i,n=(null==e?void 0:null===(i=e.aigcDraft)||void 0===i?void 0:i.content)||(null==t?void 0:t.draftContent),r=(null==e?void 0:e.aigcDraftResources)||(null==t?void 0:t.draftResources);if(!!n&&!!r&&!!e&&!!A(n)){var o=h(n,r);S(o,e.videoTemplateItem),e.aigcImageParams.text2videoParams=o}}(r,{draftContent:e.draftContent,draftResources:e.resources});var o=r?(0,m.C)(r,e.historyRecordId):void 0,a=G(e),d=D(e),s=(0,g.Qd)(e.createdTime),l=(0,g.Qd)(null!==(n=null===(i=e.task)||void 0===i?void 0:i.finishTime)&&void 0!==n?n:0);!function(e){if(!e.draftContent||!A(e.draftContent))return;var t=new I.DADraft({JSONString:e.draftContent}).findRootComponent();if(!!t&&!!T(t))t.generateType===I.DAVideoGenerateType.videoTemplate&&(e.firstGenerateType=c.pi.VideoTemplate,e.task.firstGenerateType=c.pi.VideoTemplate)}(e);var{generateType:u,firstGenerateType:v}=e;!(0,p.w)(u)&&(0,f.ss)("Video record can only be created from video type"),!function(e){if(!!e.draftContent&&!!A(e.draftContent))e.task.originalInput=h(e.draftContent,e.resources),e.task.taskPayload=function(e){if(!e)return;var t,i,n=new I.DADraft({JSONString:e}).findMainComponent();if(!!n){var{abilities:r,generateType:o}=n;return{taskExtra:null==r?void 0:null===(t=r.genVideo)||void 0===t?void 0:t.videoTaskExtra,taskScene:(null==r?void 0:null===(i=r.genVideo)||void 0===i?void 0:i.scene)||y(o)}}}(e.draftContent),e.task.processFlows=function(e){if(!!e){for(var t=new I.DADraft({JSONString:e}),i=[],n=t.findMainComponent();n&&T(n);){;i.unshift({curProcessFlows:[_[n.generateType]]}),n=t.findParentComponent(n)}return i}}(e.draftContent)}(e),S(e.task.originalInput,e.videoTemplateItem);var k=C(e.task);return!function(e,t){if(t.generateType===c.pi.VideoTemplate)e.videoTemplateItem=t.videoTemplateItem}(k,e),{id:e.task.submitId,generateType:u,firstGenerateType:v,historyRecordId:e.historyRecordId,createdTime:s,sortCreateTime:s,itemList:e.itemList,originItemList:e.originItemList,status:e.status,mode:e.mode,task:k,assetOption:e.assetOption,firstFrameImage:a,lastFrameImage:d,aigcItemId:null==o?void 0:o.aigcItemId,videoDreamina:o,historyGroupKeyMd5:null==e?void 0:e.historyGroupKeyMd5,forecastGenerateCost:null==e?void 0:e.forecastGenerateCost,forecastQueueCost:null==e?void 0:e.forecastQueueCost,finishTime:l,failCode:null==e?void 0:e.failCode}},x=(e,t)=>{var i,o,a,d,s,l,u,p,g,f,I,y,h,T,A,_,C,G,D,S,k,P,x,E,R,b,F,U,{commonAttr:w}=e,{video:M,author:O}=e,N=e.aigcImageParams,L="".concat(w.id),{requestId:V,generateId:B,generateType:W,text2videoParams:K}=null!=N?N:{},{transcodedVideo:j}=M,H=null!==(h=null!==(y=null===(i=M.transcodedVideo)||void 0===i?void 0:i["720p"])&&void 0!==y?y:null===(o=M.transcodedVideo)||void 0===o?void 0:o["360p"])&&void 0!==h?h:null===(a=M.transcodedVideo)||void 0===a?void 0:a.origin,J=(0,m.K)(M.durationInfo),z=(null==J?void 0:J.playInfoDuration)?(null==J?void 0:J.playInfoDuration)*1e3:M.durationMs,$=Math.round(z/1e3);return(0,n._)({key:L,resourceId:L,effectId:w.effectId,effectType:w.effectType,title:null!==(T=w.title)&&void 0!==T?T:"",description:w.description,coverUrl:w.coverUrl,coverUrlMap:null!==(A=w.coverUrlMap)&&void 0!==A?A:{},watermarkType:M.watermarkType,createTime:w.createTime,aspectRatio:null!==(_=w.aspectRatio)&&void 0!==_?_:1,duration:$,durationMs:z,durationInfo:0===Object.values(J).length?{playInfoDuration:$,audioStreamingDuration:$,videoStreamingDuration:$}:J,author:O?{avatar:O.avatarUrl,name:O.name,uid:O.secUid}:void 0,thumb:{thumbCommonInfo:{singleFrameHeight:null!==(C=null===(s=M.thumb)||void 0===s?void 0:null===(d=s.thumbCommonInfo)||void 0===d?void 0:d.singleFrameHeight)&&void 0!==C?C:0,singleFrameWidth:null!==(G=null===(u=M.thumb)||void 0===u?void 0:null===(l=u.thumbCommonInfo)||void 0===l?void 0:l.singleFrameWidth)&&void 0!==G?G:0,totalSetNum:null!==(D=null===(g=M.thumb)||void 0===g?void 0:null===(p=g.thumbCommonInfo)||void 0===p?void 0:p.totalSetNum)&&void 0!==D?D:0},detailInfos:null!==(S=null===(I=M.thumb)||void 0===I?void 0:null===(f=I.detailInfos)||void 0===f?void 0:f.map(e=>({frameCount:e.frameCount,imageHeight:e.imageHeight,imageWidth:e.imageWidth,mimeType:e.mimeType,url:e.url,uri:e.uri})))&&void 0!==S?S:[]},originVideo:{definition:null!==(k=null==H?void 0:H.definition)&&void 0!==k?k:"",format:null!==(P=null==H?void 0:H.format)&&void 0!==P?P:"",height:null!==(x=null==H?void 0:H.height)&&void 0!==x?x:0,width:null!==(E=null==H?void 0:H.width)&&void 0!==E?E:0,size:null!==(R=null==H?void 0:H.size)&&void 0!==R?R:0,url:null!==(b=null==H?void 0:H.videoUrl)&&void 0!==b?b:"",fps:null!==(F=null==H?void 0:H.fps)&&void 0!==F?F:0},transcode:Object.keys(null!=j?j:{}).reduce((e,t)=>{var i=null==j?void 0:j[t];return i?(0,r._)((0,n._)({},e),{[t]:{definition:i.definition,format:i.format,height:i.height,width:i.width,size:i.size,url:i.videoUrl}}):e},{}),aigcParams:{requestId:null!==(U=null!=V?V:e.requestId)&&void 0!==U?U:"",generateId:null!=B?B:"",generateType:null!=W?W:c.pi.Unknown,text2videoParams:K?(0,n._)({},K):K},videoId:M.videoId,historyRecordId:t?String(t):"",aigcItemId:w.localItemId?String(w.localItemId):"",publishedItemId:w.publishedItemId?String(w.publishedItemId):void 0,thirdResourceId:w.thirdResourceId?String(w.thirdResourceId):void 0,isMute:M.isMute},(0,v.S)(e))},E=e=>{var t,i,n,r,o;return e.task.firstFrameImage?e.task.firstFrameImage:(null===(t=e.originItemList)||void 0===t?void 0:t[0])?{imageUrl:null!==(i=e.originItemList[0].imageUrl)&&void 0!==i?i:"",imageUri:null!==(n=e.originItemList[0].uri)&&void 0!==n?n:"",width:null!==(r=e.originItemList[0].width)&&void 0!==r?r:0,height:null!==(o=e.originItemList[0].height)&&void 0!==o?o:0}:{imageUri:"",imageUrl:"",width:0,height:0}},R=e=>{try{var t,i,n,r=null===(t=e.itemList)||void 0===t?void 0:t[0],o=r?x(r,e.historyRecordId):void 0,a=E(e);return!(0,p.w)(e.generateType)&&(0,f.ss)("Video record can only be created from video type"),{firstGenerateType:e.firstGenerateType,generateType:e.generateType,historyRecordId:null!==(i=e.historyRecordId)&&void 0!==i?i:"",createdTime:(null!==(n=e.createdTime)&&void 0!==n?n:0)*1e3,itemList:e.itemList,originItemList:e.originItemList,mode:e.mode,task:C(e.task),assetOption:e.assetOption,firstFrameImage:a,aigcItemId:null==o?void 0:o.aigcItemId,videoDreamina:o,historyGroupKeyMd5:null==e?void 0:e.historyGroupKeyMd5}}catch(e){return}}}}]);